# Indoor Baby Guardian -お部屋の環境調整で幼児の安全を守ろう-


## サービス概要

屋内で幼児の怪我に不安を感じている人に
診断機能により、ユーザーの自宅内における環境調整が必要な場所・物を見つけ出し、危険なポイント及び、グッズを活用した環境調整方法を提供する
幼児のためのリスク管理サービスです。


## 想定されるユーザー層

屋内で幼児の怪我に不安を感じている人


## サービスコンセプト
- ユーザーが抱えている課題

幼児期になると、一人歩きができるようになり行動範囲が増え、目を離した隙に危険な行動により怪我をするリスクが高くなります。
しかし、核家族化の進行や共働き、ひとり親のご家庭など、幼児の行動を見守れる環境が乏しい状況で、幼児の危険な行動に伴う怪我に不安を感じていると考えました。

- 提供するサービスでどのように解決するのか

診断機能により、ユーザーの自宅内における環境調整が必要な場所・物を見つけ出し、危険なポイント及び、グッズを活用した環境調整方法を
サービスを通して認知していただき、対応していただくことで、幼児の行動を見守れる環境が乏しい状況でも、幼児の怪我のリスクを下げることができると考えています。

- なぜこのサービスを作ろうと思ったのか

核家族化の進行や共働き、ひとり親のご家庭など、幼児の行動を見守れる環境が乏しい状況でも、幼児の安全を守る手助けができるサービスを作りたいと思いました。
以前、1歳児の姪が床に落ちていたレジャーシートで足を滑らせ、床に頭をぶつけて怪我をしたことがありました。
姪の父親は仕事に出ており、姪の母親が家事で忙しく、姪から目を離した際の出来事でした。
今回の事例から、滑りやすい物は床に置かず、また、事前に衝撃吸収マットを床に敷いていれば、怪我を避けられたかもしれません。
事前に屋内における危険を把握し、グッズを活用した環境調整を実施することで、幼児の行動を見守れる環境が乏しい状況であっても、
幼児の怪我のリスクを下げることができると考えています。

- サービスの推しポイント

診断機能により、ユーザーの自宅内において、現状どこが幼児にとって危険で、グッズを用いてどういった環境調整ができるのかがわかるようになっています。
具体的には、質問に回答していただくことで、診断結果画面に自宅内で、環境調整が必要な場所・物が表示されます。
そして、診断結果画面に表示された環境調整が必要な場所・物をそれぞれタップ（クリック）すると、詳細画面が表示され、危険なポイントや、
グッズを活用した環境調整方法がわかるようになっています。また、グッズは画像付きリンクで表示しているため、すぐに販売サイトにアクセスできるようになっています。
その他の機能として、いつでも診断結果の確認や、診断結果の対応状況の管理が行える機能を実装しています。
具体的には、診断結果を保存することで、マイページからいつでも診断結果の確認ができます。
また、診断結果内のそれぞれの環境調整が必要な場所・物に「対応済にする」又は、「未対応にする」ボタンが表示され、そのボタンを使用して、
対応状況の管理が行えます。


## 実装を予定している機能
### MVP
- 診断
  - 質問回答機能
    - ウィザードフォオーム形式で質問画面を表示
  - 診断結果閲覧機能
    - 環境調整が必要な場所・物の名称を一覧で表示
      - 室内リスク詳細(診断結果画面に表示されている名称をクリックして遷移)
        - 環境調整が必要な場所・物の詳細情報(危険なポイント、グッズ等を紹介)
        - 「楽天アフィリエイト」を使用して、グッズの画像付きリンクを表示
  - 診断結果保存機能（ログイン必要）

- ユーザー投稿
  - 記事投稿機能（ログイン必要）
    - 画像投稿は複数枚可能
      - ImageMagick,MiniMagickで画像加工
      - Active Storageで画像保存
  - 記事閲覧機能
  - 記事編集機能（ログイン必要）
  - 記事削除機能（ログイン必要）
  - コメント投稿機能（ログイン必要）
  - コメント閲覧機能
  - コメント編集機能（ログイン必要）
  - コメント削除機能（ログイン必要）
  - コメント返信機能（ログイン必要）
  - いいね機能（ログイン必要）
  - いいね解除機能（ログイン必要）
  - お気に入り登録機能（ログイン必要）
  - お気に入り解除機能（ログイン必要）
  - 通知機能（ログイン必要）
    - 自分の投稿した記事に対して、コメントされた際に通知する
    - 投稿したコメントに対して、返信コメントが送信された際に通知する
  - 通知履歴削除機能（ログイン必要）

- マイページ（ログイン必要）
  - ユーザー情報編集機能（ログイン必要）
    - 「アバター」、「ユーザー名」、「メールアドレス」が変更可能
  - 診断結果（ログイン必要）
    - 診断結果一覧機能
    - 診断結果管理機能
      - 「対応済にする」、「未対応にする」ボタンを用いて、診断結果を管理できる
    - 診断結果タイトル編集機能
  - 自身が投稿した記事の一覧機能
  - お気に入り登録した記事の一覧機能

- 会員登録・ログイン
  - Google認証機能
  - ゲストログイン機能
  - パスワードリマインダー機能

- その他
  - 検索機能
  - ページネーション機能
  - SNS（X）シェア機能
  - 問い合わせ機能

### MVP後の機能
- 室内におけるリスク一覧の閲覧機能
  - 室内におけるリスクの一覧及び、その詳細を閲覧できるようにする
  - 上記の各詳細画面に「Amazonアフィリエイト」を使用した、グッズの画像付きリンクを追加
- 画像投稿機能
  - スマホで直接写真撮影した画像を添付できるようにする
- ログイン機能
  - 入力中のパスワードを表示させる機能


## 画面遷移図
[Figma](https://www.figma.com/file/EWhhdX6Laad9SzDdOefpUk/children_risk_management_app?type=design&node-id=0%3A1&mode=design&t=J85eOYoD4gyJ7fTA-1)


## ER図
![Alt text](app/assets/images/children_risk_ER%E5%9B%B3.drawio.png)


## 使用技術
### フロントエンド
- HTML / CSS / JavaScript (Turbo,Stimulus)
- CSS frame-work
  - Bootstrap 5.3.2

### バックエンド
- Ruby 3.2.2
- Rails 7.1.2

### インフラ
- Heroku
  - PostgreSQL (データベース)
  - Redis (セッション管理)
- Amazon S3 (画像データの保存)

## 現在のつまりポイント
### 現在発生している問題
本番環境での記事投稿機能において、画像を添付して投稿すると、投稿完了まで10秒以上かかってしまいます。
画像は最大4枚まで添付可能で、1枚あたり約120KBの画像を４枚添付して投稿したところ、投稿完了まで10秒以上かかってしまいます。
### 考えている対策
現在、画像処理（リサイズ）には、「mini_magick」を使用しています。これを、「vips」に変更する予定です。
記事で「VIPSは、高速でメモリ効率が高い画像処理ライブラリです。mini_magickよりも高速であり、大量の画像を効率的に処理する際に特に有用です。」
という内容を見つけ、一度試してみようと考えています。
